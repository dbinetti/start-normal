{% extends 'app/base.html' %}

{% load bootstrap4 %}
{% load humanize %}

{% block title %}Homeroom{% endblock title %}
{% block header %}Homeroom{% endblock header %}

{% block content %}
  <section class='my-5'>
    <p class='lead'>
      {% if homeroom.classmates.count %}
        This Homeroom is a stable cohort of {{homeroom.classmates.count}} students from the following schools and grades:<br>
        <strong>{{homeroom.schools|join:", "}}; {{homeroom.grades|join:", "}}</strong>
      {% else %}
        There are no students currently in this Homeroom.
      {% endif %}
    </p>
  </section>
  <section>
    <p>
      {# Current Status:  {{homeroom.get_status_display}}<br> #}
      If you'd like to join this Homeroom, please reach out to the Room Parent:  {{homeroom.parent.user.name}}, <a href='mailto:{{homeroom.parent.user.email}}'>{{homeroom.parent.user.email}}</a>
    </p>
  </section>
  <section class='mt-2 mt-5'>
    <div class='card'>
      <div class='card-header'>
        <h4>Homeroom Classmates</h4>
      </div>
      <div class='card-body'>
        <div class='table-responsive-lg mb-5'>
          <table class='table table-sm'>
            <thead>
              <tr>
                <th>
                  Classmate Name
                </th>
                <th>
                  Parent Name
                </th>
                <th>
                  Parent Email
                </th>
              </tr>
            </thead>
            <tbody>
              {% for classmate in classmates %}
                <tr>
                  <td>
                    <a href='{% url "classmate" classmate.id %}'>{{classmate.student.name|default:"(Unknown)"}}</a>
                  </td>
                  <td>
                    {{classmate.student.parent}}
                  </td>
                  <td>
                    <a href='mailto:{{classmate.student.parent.user.email}}'>{{classmate.student.parent.user.email}}</a>
                  </td>
                </tr>
              {% empty %}
                <tr>
                  <td colspan=3>
                    (No Classmates in this Homeroom)
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
      <div class='card-footer'>
        <p>
          {# <a href='{% url "add-classmate" homeroom.id %}'>Add a Student</a> #}
        </p>
      </div>
    </div>
  </section>


  {% if homeroom.parent == request.user.parent %}
  <section class='my-5'>
    <p>
      As a Room Parent, you can automatically add any of the following students to your homeroom by clicking the "Add to this Homeroom" link.
    </p>
  </section>
  <section class='my-5'>
    <div class='card'>
      <div class='card-header'>
        <h4>Potential Classmates</h4>
      </div>
      <div class='card-body'>
        <table class='table'>
          <thead>
            <th>
              Grade
            </th>
            <th>
              Student Name
            </th>
            <th>
              Parent Name
            </th>
            <th>
              Parent Email
            </th>
            <th>
              Add to Homeroom
            </th>
          </thead>
          <tbody>
            {% for student in students %}
              <tr>
                <td>
                  {{student.get_grade_display}}
                </td>
                <td>
                  {{student.name}}
                </td>
                <td>
                  {{student.parent.user.name}}
                </td>
                <td>
                  <a href='mailto:{{student.parent.user.email}}'>{{student.parent.user.email}}</a>
                </td>
                <td>
                  <a href='{% url "add-classmate-from-student" homeroom.id student.id %}'>Add to this Homeroom</a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      <div class='card-footer'>
        <p>
          {# I am hard at work to create a tool to help you form Homerooms.  In the meantime, to add any of these students to your Homeroom please email me at <a href='mailto:dbinetti@startnormal.com'>dbinetti@startnormal.com</a> or call/text 415.713.2126 #}
        </p>
      </div>
    </div>
  </section>
  {% endif %}
{% endblock content %}
